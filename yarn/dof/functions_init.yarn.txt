// Initialize styles
title: DofFunctionInitStyles
---
    <<set $dofColorValue                                to "[color=#f3cd1d]">>
    <<set $dofColorOKValue                              to "[color=#447506]">>
    <<set $dofColorNOKValue                             to "[color=#a7360d]">>
    <<set $dofColorEnd                                  to "[/color]">>
===

// some often used menus names, which will be translated during initialization
title: DofFunctionInitTranslations
---
    // stats
    <<set $dofTranslateConstitution                     to "Constitution">> #line:
    <<set $dofTranslateListen                           to "Listen">> #line:
    <<set $dofTranslatePerception                       to "Perception">> #line:
    <<set $dofTranslateSneak                            to "Sneak">> #line:
    <<set $dofTranslateSpeed                            to "Speed">> #line:
    <<set $dofTranslateAttack                           to "Attack">> #line:
    <<set $dofTranslateDefense                          to "Defense">> #line:

    <<set $dofTranslateConstitutionDescription          to "Constitution Description">> #line:
    <<set $dofTranslateListenDescription                to "Listen Description">> #line:
    <<set $dofTranslatePerceptionDescription            to "Perception Description">> #line:
    <<set $dofTranslateSneakDescription                 to "Sneak Description">> #line:
    <<set $dofTranslateSpeedDescription                 to "Speed Description">> #line:
    <<set $dofTranslateAttackDescription                to "Attack Description">> #line:
    <<set $dofTranslateDefenseDescription               to "Defense Description">> #line:

    // menus
    <<set $dofTranslateInventory                        to "Inventory">> #line:
    <<set $dofTranslateEquipment                        to "Equipment">> #line:
===

// variables with ingame variable names
title: DofFunctionInitSlotNames
---
    <<set $dofNameInventorySlot                         to "DofEnvSlot">>
    <<set $dofNameRoomArea                              to "DofRoomArea">>
    <<set $dofNameRandomGeneratorSlot                   to "DofRandSlot">>
    <<set $dofNameChestItemSlot                         to "DofChestItemSlot">>
    <<set $dofNameAltChestItemSlot                      to "DofAltChestItemSlot">>
===


title: DofFunctionInitImagePaths
---
    // stats
    <<set $dofImageConstitution                         to "img/dof/game-icons/hearts.png">>
    <<set $dofImageListen                               to "img/dof/game-icons/human-ear.png">>
    <<set $dofImagePerception                           to "img/dof/game-icons/eyeball.png">>
    <<set $dofImageSneak                                to "img/dof/game-icons/hooded-figure.png">>
    <<set $dofImageSpeed                                to "img/dof/game-icons/wingfoot.png">>
    <<set $dofImageAttack                               to "img/dof/game-icons/biceps.png">>
    <<set $dofImageDefense                              to "img/dof/game-icons/bordered-shield.png">>

    // inline stats
    <<set $dofImageInlineConstitution                   to "[img]{$dofImageConstitution}[/img]">>
    <<set $dofImageInlineListen                         to "[img]{$dofImageListen}[/img]">>
    <<set $dofImageInlinePerception                     to "[img]{$dofImagePerception}[/img]">>
    <<set $dofImageInlineSneak                          to "[img]{$dofImageSneak}[/img]">>
    <<set $dofImageInlineSpeed                          to "[img]{$dofImageSpeed}[/img]">>
    <<set $dofImageInlineAttack                         to "[img]{$dofImageAttack}[/img]">>
    <<set $dofImageInlineDefense                        to "[img]{$dofImageDefense}[/img]">>

    // levelup
    <<set $dofImageStatsLevelUp                         to "{$dofImageConstitution}">> // TODO other stats image
    <<set $dofImageFobiaLevelUp                         to "{$dofImagePerception}">> // TODO other fobia image

    // inventory
    <<set $dofImageInventoryEmptySlot                   to "img/dof/game-icons/swap-bag.slot.png">>

    // equipment
    <<set $dofImageEquipmentNecklaceEmptySlot           to "img/dof/game-icons/gem-pendant.slot.png">> // necklace
    <<set $dofImageEquipmentHelmEmptySlot               to "img/dof/game-icons/spartan-helmet.slot.png">> // helm
    <<set $dofImageEquipmentRingEmptySlot               to "img/dof/game-icons/power-ring.slot.png">> // ring
    <<set $dofImageEquipmentRightArmEmptySlot           to "img/dof/game-icons/gloves.slot.png">> // right arm
    <<set $dofImageEquipmentBodyEmptySlot               to "img/dof/game-icons/lamellar.slot.png">> // body
    <<set $dofImageEquipmentLeftArmEmptySlot            to "img/dof/game-icons/gloves.slot.png">> // left arm
    <<set $dofImageEquipmentQuick1EmptySlot             to "img/dof/game-icons/knapsack.slot.png">> // quick slot 1
    <<set $dofImageEquipmentBootsEmptySlot              to "img/dof/game-icons/boots.slot.png">> // boots
    <<set $dofImageEquipmentQuick2EmptySlot             to "img/dof/game-icons/knapsack.slot.png">> //  quick slot 1

    // map empty ground
    <<set $dofImageLeftTopGround                        to "img/dof/game-ground/LTGround.png">>
    <<set $dofImageTopGround                            to "img/dof/game-ground/TopGround.png">>
    <<set $dofImageRightTopGround                       to "img/dof/game-ground/RTGround.png">>

    <<set $dofImageLeftMidGround                        to "img/dof/game-ground/LMGround.png">>
    <<set $dofImageMiddleGround                         to "img/dof/game-ground/MidGround.png">>
    <<set $dofImageRightMidGround                       to "img/dof/game-ground/RMGround.png">>

    <<set $dofImageLeftBottomGround                     to "img/dof/game-ground/LBGround.png">>
    <<set $dofImageBottomGround                         to "img/dof/game-ground/BottomGround.png">>
    <<set $dofImageRightBottomGround                    to "img/dof/game-ground/RBGround.png">>

    <<set $dofImageMiddleCorridorGround                 to "img/dof/game-ground/MidCorridorGround.png">>
    <<set $dofImageMiddleCorridorCharGround             to "img/dof/game-ground/MidCorridorCharGround.png">>

    // map doors
    <<set $dofImageTopDoor                              to "img/dof/game-ground/TopDoor.png">>
    <<set $dofImageRightDoor                            to "img/dof/game-ground/RightDoor.png">>
    <<set $dofImageLeftDoor                             to "img/dof/game-ground/LeftDoor.png">>
    <<set $dofImageBottomDoor                           to "img/dof/game-ground/BottomDoor.png">>

    <<set $dofImageRightCorridorDoor                    to "img/dof/game-ground/RightCorridorDoor.png">>
    <<set $dofImageLeftCorridorDoor                     to "img/dof/game-ground/LeftCorridorDoor.png">>

    // map other
    <<set $dofImageExit                                 to "img/dof/assets/Isometric dungeon tiles 2d by RgsDev/Isometric tiles/Ladder 1 Left.png">>
    <<set $dofImageChest                                to "img/dof/assets/Isometric dungeon tiles 2d by RgsDev/Isometric tiles/Chest Left Opened.png">>
    <<set $dofImageAltar                                to "img/dof/assets/Isometric dungeon tiles 2d by RgsDev/Isometric tiles/Pilar.png">>
    <<set $dofImageTrader                               to "img/dof/assets/dungeon-tileset/NPC/Char1.png">>
    <<set $dofImageEvent                                to "img/dof/assets/dungeon-tileset/NPC/Skull.png">>
    <<set $dofImageEnemyPartPath                        to "img/dof/assets/dungeon-tileset/NPC/NPC">>
    <<set $dofImageEnemy1                               to "img/dof/assets/dungeon-tileset/NPC/NPC1.png">>
    <<set $dofImageEnemy2                               to "img/dof/assets/dungeon-tileset/NPC/NPC2.png">>
    <<set $dofImageEnemy3                               to "img/dof/assets/dungeon-tileset/NPC/NPC3.png">>
    <<set $dofImageEnemy4                               to "img/dof/assets/dungeon-tileset/NPC/NPC4.png">>
    <<set $dofImageEnemy5                               to "img/dof/assets/dungeon-tileset/NPC/NPC5.png">>

    // player
    <<set $dofImageCommonPlayer                         to "img/dof/game-player/Char1.png">>

    // menu
    <<set $dofImageMenuArrowUp                          to "img/dof/game-menu/Arrow-up.png">>
    <<set $dofImageMenuArrowDown                        to "img/dof/game-menu/Arrow-down.png">>
    <<set $dofImageMenuArrowRight                       to "img/dof/game-menu/Arrow-right.png">>
    <<set $dofImageMenuArrowLeft                        to "img/dof/game-menu/Arrow-left.png">>

===

// Initialize player stats
title: DofFunctionInitNewPlayerStats
---
    // stat limits
    <<set $dofPlayer.dofStatMin                         to 1>> // max 5
    <<set $dofPlayer.dofStatMax                         to 5>> // max 5
    <<set $dofPlayer.dofStatPointsLeft                  to 11>> // max (35/2)+1 -7 of initial = 11

    // initialize player stats
    <<set $dofPlayer.dofStatConstitution                to $dofPlayer.dofStatMin>>
    <<set $dofPlayer.dofStatListen                      to $dofPlayer.dofStatMin>>
    <<set $dofPlayer.dofStatPerception                  to $dofPlayer.dofStatMin>>
    <<set $dofPlayer.dofStatSneak                       to $dofPlayer.dofStatMin>>
    <<set $dofPlayer.dofStatSpeed                       to $dofPlayer.dofStatMin>>
    <<set $dofPlayer.dofStatAttack                      to $dofPlayer.dofStatMin>>
    <<set $dofPlayer.dofStatDefense                     to $dofPlayer.dofStatMin>>

    // initialize inventory size
    <<set $dofPlayer.dofInventorySize                   to 5>>

===

// New game initialization
title: DofFunctionGameInit
---

    //  TODO choose gender with blocks
    // -> He
    //     <<set $dofPlayer.dofGender        to "he">>
    // -> She
    //     <<set $dofPlayer.dofGender        to "she">>
    // -> They
    //     <<set $dofPlayer.dofGender        to "they">>


    // initialize players stats
    <<hagCallNode name="DofFunctionInitNewPlayerStats">>

    // initialize gold
    <<set $dofPlayer.dofGold to 0>>

    // initialize inventory
    <<set $dofIndex to 0>>
    <<while $dofIndex is not $dofPlayer.dofInventorySize>>
        <<set $dofSlot to "{$dofNameInventorySlot}{$dofIndex}">>

        <<set $dofSlot.$dofUsed         to false>>
        <<set $dofSlot.$dofName         to "">>
        <<set $dofSlot.$dofImage        to "">>
        <<set $dofSlot.$dofCanEquip     to false>>
        <<set $dofSlot.$dofCanConsume   to false>>
        <<set $dofSlot.$dofCanDrop      to false>>

        <<set $dofIndex to $dofIndex + 1>>
    <<endwhile>>

    // initialize player location
    <<set $dofPlayer.dofX               to 0>>
    <<set $dofPlayer.dofY               to 0>>
    <<set $dofPlayer.dofNextX           to 0>>
    <<set $dofPlayer.dofNextY           to 0>>

    // initialize stat indexes, used for random stat distribution
    <<set $dofStatConstitutionId        to 1>>
    <<set $dofStatListenId              to 2>>
    <<set $dofStatPerceptionId          to 3>>
    <<set $dofStatSneakId               to 4>>
    <<set $dofStatSpeedId               to 5>>
    <<set $dofStatAttackId              to 6>>
    <<set $dofStatDefenseId             to 7>>

    <<set $dofStatMinId                 to $dofStatConstitutionId>>
    <<set $dofStatMaxId                 to $dofStatDefenseId>>

    // initialize item type indexes, used for random item generation
    <<set $dofItemMoneyId               to 1>>
    <<set $dofItemPotionId              to 2>>
    <<set $dofItemRingId                to 3>>
    <<set $dofItemNecklaceId            to 4>>
    <<set $dofItemToolsId               to 5>>
    <<set $dofItemBagId                 to 6>>
    <<set $dofItemScrollId              to 7>>
    <<set $dofItemWeaponId              to 8>>
    <<set $dofItemArmorId               to 9>>

    <<set $dofItemMinId                 to $dofItemMoneyId>>
    <<set $dofItemMaxId                 to $dofItemArmorId>>

    // initialize room areas type indexes, used for random room generation
    <<set $dofRoomAreaLTId              to 1>>
    <<set $dofRoomAreaLMTId             to 2>>
    <<set $dofRoomAreaRMTId             to 3>>
    <<set $dofRoomAreaRTId              to 4>>
    <<set $dofRoomAreaLMId              to 5>>
    <<set $dofRoomAreaLMMId             to 6>>
    <<set $dofRoomAreaRMMId             to 7>>
    <<set $dofRoomAreaRMId              to 8>>
    <<set $dofRoomAreaLBId              to 9>>
    <<set $dofRoomAreaLMBId             to 10>>
    <<set $dofRoomAreaRMBId             to 11>>
    <<set $dofRoomAreaRBId              to 12>>

    <<set $dofRoomAreaMinId             to $dofRoomAreaLTId>>
    <<set $dofRoomAreaMaxId             to $dofRoomAreaRBId>>

===

// Initialize function parameters to help variable detection
// if function is not used, the variable discovery will not find it
title: DofFunctionInitParams
---
===

// on start initialization
title: DofFunctionInitOnStart
---
    <<hagCallNode name="DofFunctionInitStyles">>
    <<hagCallNode name="DofFunctionInitImagePaths">>
    <<hagCallNode name="DofFunctionInitSlotNames">>
    <<hagCallNode name="DofFunctionInitRoomConstants">>

    // TODO language detection

    <<hagCallNode name="DofFunctionInitTranslations">>

===

