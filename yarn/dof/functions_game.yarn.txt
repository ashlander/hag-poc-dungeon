// Add empty block
title: DofFunctionAddEmptyBlock
---
    // TODO type=gap
    <<hagHighlightBlockSet type=image>>
===

// Add player image
title: DofFunctionAddPlayerImage
---
    // TODO look depends on equipment

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageCommonPlayer}">>
===

/**
 * @brief Add npc stats
 * @param DofFunctionAddNpcStats_actor Actor name with stats
 */
title: DofFunctionAddNpcStats
---
    // add player stats
    <<hagHighlightBlockSet type=value>>
    <<hagHighlightBlockNoteAdd text="{$dofTranslateConstitution}"   value=$_actor.$dofStatConstitution  path="{$dofImageConstitution}">>
    <<hagHighlightBlockNoteAdd text="{$dofTranslateListen}"         value=$_actor.$dofStatListen        path="{$dofImageListen}">>
    <<hagHighlightBlockNoteAdd text="{$dofTranslatePerception}"     value=$_actor.$dofStatPerception    path="{$dofImagePerception}">>
    <<hagHighlightBlockNoteAdd text="{$dofTranslateSneak}"          value=$_actor.$dofStatSneak         path="{$dofImageSneak}">>
    <<hagHighlightBlockNoteAdd text="{$dofTranslateSpeed}"          value=$_actor.$dofStatSpeed         path="{$dofImageSpeed}">>
    <<hagHighlightBlockNoteAdd text="{$dofTranslateAttack}"         value=$_actor.$dofStatAttack        path="{$dofImageAttack}">>
    <<hagHighlightBlockNoteAdd text="{$dofTranslateDefense}"        value=$_actor.$dofStatDefense       path="{$dofImageDefense}">>

===

// Add current players stats
title: DofFunctionAddPlayerStats
---
    <<set $DofFunctionAddNpcStats_actor to "dofPlayer">>
    <<hagCallNode name="DofFunctionAddNpcStats">>
===

title: DofFunctionAddPlayerStatsWithPoints
---
    <<hagCallNode name="DofFunctionAddPlayerImage">>
    <<hagCallNode name="DofFunctionAddPlayerStats">>
    <<hagCallNode name="DofFunctionAddEmptyBlock">>

    <<hagCallNode name="DofFunctionAddEmptyBlock">>
    <<hagCallNode name="DofFunctionAddNewPlayerStatPoints">>
    <<hagCallNode name="DofFunctionAddEmptyBlock">>
===

// Add current players stats without description (short form)
title: DofFunctionAddPlayerStatsShort
---
    // add player stats
    <<hagHighlightBlockSet type=value>>
    <<hagHighlightBlockNoteAdd value=$dofPlayer.dofStatConstitution  path="{$dofImageConstitution}">>
    <<hagHighlightBlockNoteAdd value=$dofPlayer.dofStatListen        path="{$dofImageListen}">>
    <<hagHighlightBlockNoteAdd value=$dofPlayer.dofStatPerception    path="{$dofImagePerception}">>
    <<hagHighlightBlockNoteAdd value=$dofPlayer.dofStatSneak         path="{$dofImageSneak}">>
    <<hagHighlightBlockNoteAdd value=$dofPlayer.dofStatSpeed         path="{$dofImageSpeed}">>
    <<hagHighlightBlockNoteAdd value=$dofPlayer.dofStatAttack        path="{$dofImageAttack}">>
    <<hagHighlightBlockNoteAdd value=$dofPlayer.dofStatDefense       path="{$dofImageDefense}">>

===

// Add left stat points to distribute
title: DofFunctionAddNewPlayerStatPoints
---
    <<if $dofPlayer.dofStatPointsLeft > 0>>
        <<set $dofValueColor to $dofColorValue>>
    <<elseif $dofPlayer.dofStatPointsLeft == 0>>
        <<set $dofValueColor to $dofColorOKValue>>
    <<elseif $dofPlayer.dofStatPointsLeft < 0>>
        <<set $dofValueColor to $dofColorNOKValue>>
    <<endif>>

    <<hagHighlightBlockSet type=info>>
    <<hagHighlightBlockNoteAdd text="{$dofValueColor}{$dofPlayer.dofStatPointsLeft}{$dofColorEnd} points left to distribute">>
===

// Add current players stats level up menu group
title: DofFunctionAddPlayerStatsLevelUp
---
    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageStatsLevelUp}">>
===

// Add current players fobia level up menu group
title: DofFunctionAddPlayerFobiaLevelUp
---
    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageFobiaLevelUp}">>
===

// Add current players each stat as levelup menu group
title: DofFunctionAddPlayerStatsEachLevelUp
---
    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageConstitution}" onclick="Constitution">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageListen}" onclick="Listen">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImagePerception}" onclick="Perception">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageSneak}" onclick="Sneak">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageSpeed}" onclick="Speed">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageAttack}" onclick="Attack">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageMenuArrowLeft}" onclick="Back">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageDefense}" onclick="Defense">>

===


// Add inventory title
title: DofFunctionAddPlayerInventoryTitle
---
    // add inventory title
    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd text="{$dofTranslateInventory}">>
===

// Add inventory items
title: DofFunctionAddPlayerInventory
---
    <<set $dofIndex            to 0>>
    <<while $dofIndex is not $dofPlayer.dofInventorySize>>
        <<set $dofItemSlot to "{$dofNameInventorySlot}{$dofIndex}">>

        <<hagHighlightBlockSet type=image>>
        <<if $dofItemSlot.$dofUsed>>
            <<hagHighlightBlockNoteAdd path=$dofItemSlot.$dofImage text="{$dofItemSlot.$dofName}">>
        <<else>>
            <<hagHighlightBlockNoteAdd path="{$dofImageInventoryEmptySlot}">>
        <<endif>>

        <<set $dofIndex to $dofIndex + 1>>
    <<endwhile>>
===

// Add equipment title
title: DofFunctionAddPlayerEquipmentTitle
---
    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd text="{$dofTranslateEquipment}">>
===

// Add equipment items
title: DofFunctionAddPlayerEquipment
---
    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageEquipmentNecklaceEmptySlot}">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageEquipmentHelmEmptySlot}">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageEquipmentRingEmptySlot}">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageEquipmentRightArmEmptySlot}">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageEquipmentBodyEmptySlot}">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageEquipmentLeftArmEmptySlot}">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageEquipmentQuick1EmptySlot}">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageEquipmentBootsEmptySlot}">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageEquipmentQuick2EmptySlot}">>
===

// Show room map template
title: DofFunctionAddMapCorridorTemplate
---
    // mid row
    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageLeftCorridorDoor}"           style="room" onclick="LeftDoor">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageMiddleCorridorCharGround}"   style="room" onclick="Player">>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageMiddleCorridorGround}"       style="room" >>

    <<hagHighlightBlockSet type=image>>
    <<hagHighlightBlockNoteAdd path="{$dofImageRightCorridorDoor}"          style="room" onclick="RightDoor">>
===

/**
 * @brief Reset unit stats to 0
 * @param DofFunctionResetStats_actor Actor name with stats to reset
 */
title: DofFunctionResetStats
---
    <<set $_actor.$dofStatConstitution     to 0>>
    <<set $_actor.$dofStatListen           to 0>>
    <<set $_actor.$dofStatPerception       to 0>>
    <<set $_actor.$dofStatSneak            to 0>>
    <<set $_actor.$dofStatSpeed            to 0>>
    <<set $_actor.$dofStatAttack           to 0>>
    <<set $_actor.$dofStatDefense          to 0>>
===

/**
 * @brief Populates unit with random stats
 * previously set stats will not be erased
 * @param DofFunctionGenerateRandomStats_actor Actor name with stats to populate
 * expected
 *  dofStatMax - max stat value
 *  dofStatMin - min stat value
 *  dofStatPointsLeft - stat points to distribute
 */
title: DofFunctionGenerateRandomStats
---
    <<set $dofStatId                to 0>>

    // random point iteration
    <<while $_actor.$dofStatPointsLeft is not 0>>

        <<set $dofStatId to random($dofStatMinId, $dofStatMaxId)>>

        // Constitution
        <<if $dofStatId is $dofStatConstitutionId and $_actor.$dofStatConstitution < $_actor.$dofStatMax>>
            <<set $_actor.$dofStatConstitution to $_actor.$dofStatConstitution + 1>>
            <<set $_actor.$dofStatPointsLeft to $_actor.$dofStatPointsLeft - 1>>
        <<endif>>

        // Listen
        <<if $dofStatId is $dofStatListenId and $_actor.$dofStatListen < $_actor.$dofStatMax>>
            <<set $_actor.$dofStatListen to $_actor.$dofStatListen + 1>>
            <<set $_actor.$dofStatPointsLeft to $_actor.$dofStatPointsLeft - 1>>
        <<endif>>

        // Perception
        <<if $dofStatId is $dofStatPerceptionId and $_actor.$dofStatPerception < $_actor.$dofStatMax>>
            <<set $_actor.$dofStatPerception to $_actor.$dofStatPerception + 1>>
            <<set $_actor.$dofStatPointsLeft to $_actor.$dofStatPointsLeft - 1>>
        <<endif>>

        // Sneak
        <<if $dofStatId is $dofStatSneakId and $_actor.$dofStatSneak < $_actor.$dofStatMax>>
            <<set $_actor.$dofStatSneak to $_actor.$dofStatSneak + 1>>
            <<set $_actor.$dofStatPointsLeft to $_actor.$dofStatPointsLeft - 1>>
        <<endif>>

        // Speed
        <<if $dofStatId is $dofStatSpeedId and $_actor.$dofStatSpeed < $_actor.$dofStatMax>>
            <<set $_actor.$dofStatSpeed to $_actor.$dofStatSpeed + 1>>
            <<set $_actor.$dofStatPointsLeft to $_actor.$dofStatPointsLeft - 1>>
        <<endif>>

        // Attack
        <<if $dofStatId is $dofStatAttackId and $_actor.$dofStatAttack < $_actor.$dofStatMax>>
            <<set $_actor.$dofStatAttack to $_actor.$dofStatAttack + 1>>
            <<set $_actor.$dofStatPointsLeft to $_actor.$dofStatPointsLeft - 1>>
        <<endif>>

        // Defense
        <<if $dofStatId is $dofStatDefenseId and $_actor.$dofStatDefense < $_actor.$dofStatMax>>
            <<set $_actor.$dofStatDefense to $_actor.$dofStatDefense + 1>>
            <<set $_actor.$dofStatPointsLeft to $_actor.$dofStatPointsLeft - 1>>
        <<endif>>

    <<endwhile>>
===
